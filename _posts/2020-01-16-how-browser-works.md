---



layout: post

title: "'브라우저는 어떻게 동작하는가?' 공부하면서 정리"

comment: true

tags:
- 브라우저
- JavaScript
- Web
- 기초

categories: [Web]

---

Naver D2에 올라온 번역글 '브라우저는 어떻게 동작하는가?'를 읽으면서 정리한 내용입니다.  
출처: https://d2.naver.com/helloworld/59361
  
크롬, 파이어폭스, 사파리와 같은 오픈소스 브라우저의 예

## 브라우저의 주요 기능
- 사용자가 선택한 자원을 서버에 요청하고 브라우저에 표시하는 것
- 자원은 보통 html 문서이지만 pdf나 이미지일 수도 있다
- 자원의 주소는 URI(Uniform Resource Identifier)에 의해 정해진다
- 브라우저는 html과 css 명세에 따라 html을 해석해 표현. 예전에는 브라우저들이 독자적인 방법으로 해석해 호환성 문제가 있었지만, 최근에는 대부분 브라우저가 표준 명세를 따름.
- 브라우저의 사용자 인터페이스는 서로 비슷

## 브라우저의 기본 구조
- 사용자 인터페이스: 주소 표시줄, 이전/다음 버튼 등. 요청한 페이지를 보여주는 부분 외 전부
- 브라우저 엔진: 사용자 인터페이스와 렌더링 엔진 사이 동작 제어
- 렌더링 엔진: 요청한 컨텐츠를 표시
- 통신: HTTP 요청과 같은 네트워크 호출에 사용
- UI 백엔드: 콤보 박스와 창 같은 기본적인 장치를 그림
- 자바스크립트 해석기: 자바스크립트 코드를 해석하고 실행
- 자료 저장소: 자료를 저장하는 계층. HTML5 명세에는 브라우저가 지원하는 '웹 데이터 베이스'가 정의됨

## 렌더링 엔진

### 렌더링 엔진들
파이어폭스와 크롬, 사파리는 두 종류의 렌더링 엔진으로 제작됨. 파이어폭스는 모질라에서 만든 Gecko 엔진을 사용하고 크롬은 Webkit 엔진을 사용함. 

### 동작 과정
렌더링 엔진은 통신으로부터 요청한 문서의 내용을 얻는 것으로 시작. 
렌더링 엔진의 기본 동작 과정
- DOM 트리 구축 위한 HTML 파싱
- 렌더 트리 구축
- 렌더 트리 배치
- 렌더 트리 그리기

렌더링 엔진은 html 문서를 파싱하고 "콘텐츠 트리" 내부에서 태그를 dom 노드로 변환. 그 다음 외부 css 파일과 함께 포함된 스타일 요소도 파싱. 스타일 정보와 html 표시 규칙은 "렌더 트리"라 불리는 또 다른 트리 생성
  
렌더 트리는 색상 또는 면적과 같은 시각적 속성이 있는 사각형을 포함하고 있는데 정해진 순서대로 화면에 표시된다. 
  
렌더 트리 생성이 끝나면 배치 시작. 노드가 화면의 정확한 위치에 표시됨. 

## 파싱과 DOM 트리 구축
### 파싱 일반
문서 파싱은 브라우저가 코드를 이해하고 사용할 수 있는 구조로 변환하는 것. 파싱 결과는 보통 문서 구조를 나타내는 노드 트리. parsing tree, syntax tree라고도 함. 

### 문법
파싱할 수 있는 모든 형식은 정해진 용어와 구문 규칙에 따라야 한다. 이것을 문맥 자유 문법이라고 함. 

### 파서-어휘 분석기 조합
파싱은 어휘 분석과 구문 분석 두 가지로 구분할 수 있다.  
어휘 분석은 자료를 토큰으로 분해하는 과정. 토큰은 유효하게 구성된 단위의 집합체.  
구문 분석은 언어의 구문 규칙을 적용하는 과정.  
파서는 보통 두 가지 일을 함. 자료를 유효한 토큰으로 분해하는 어휘 분석기와 언어 규칙에 따라 문서 구조를 분석함으로써 파싱 트리를 생성하는 파서. 어휘 분석기는 공백과 줄 바꿈 같은 의미 없는 문자를 제거.  
파싱 과정은 반복됨.  
규칙에 맞지 않으면 파서는 토큰을 내부적으로 저장하고 토큰과 일치하는 규칙이 발견될 때까지 요청. 맞는 규칙이 없는 경우 예외로 처리하는데 이는 문서가 구문 오류를 포함하고 있다는 것.  

### 변환
파싱은 보통 문서를 다른 양식으로 변환하는데 컴파일이 하나의 예. 컴파일러는 파싱 트리 생성 후 이를 기계 코드 문서로 변환한다. 

### 파서의 종류
하향식 파서와 상향식 파서. 하향식은 구문의 상위 구조로부터 일치하는 부분을 찾기 시작하고 상향식 파서는 낮은 수준에서 점차 높은 수준으로 찾는다. 

### 파서 자동 생성
파서를 생성해주는 도구가 파서 생성기.  
웹킷은 두 개의 파서 생성기 - 어휘 생성을 위한 Flex와 파서 생성을 위한 Bison 사용. 플렉스는 토큰의 정규 표현식 정의를 포함하는 파일을 입력받고 바이슨은 BNF 형식의 언어 구문 규칙을 입력 받음. 

## HTML 파서
HTML 마크업을 파싱 트리로 변환  
모든 전통적인 파서는 HTML에 적용할 수 없음. 다만 파싱은 css와 자바스크립트를 파싱하는데 사용됨.  
HTML 정의를 위한 공식적인 형식으로 DTD(문서 형식 정의)가 있지만 이것은 문맥 자유 문법이 아님.  

### HTML DTD
HTML의 정의는 SGML 계열 언어의 정의를 이용한 것.  
DTD는 여러 변종이 있다. 엄격한 형식은 명세만을 따르지만 다른 형식은 낡은 브라우저에서 사용된 마크업을 지원.

### DOM
"파싱 트리"는 DOM 요소와 속성 노드의 트리로서 출력 트리가 된다. DOM은 문서 객체 모델(Document Object Model)의 준말. 
  
DOM은 마크업과 1:1 관계를 맺는다. 

